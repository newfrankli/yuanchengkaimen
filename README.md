# 智能家居控制系统

基于ESP8266的智能家居控制系统，支持空调控制和门锁控制功能。

## 项目功能

### 1. 空调控制
- **开关控制**：远程控制空调的开/关
- **温度调节**：支持16-30℃的温度调节
- **运行模式**：支持自动、制冷、制热、除湿、送风五种模式
- **风速控制**：支持自动、1-5档风速调节
- **扫风控制**：支持上下扫风和左右扫风的开启/关闭
- **灯光控制**：控制空调显示屏灯光的开启/关闭
- **睡眠模式**：支持5种睡眠模式切换
- **定时功能**：支持0.5-24小时的定时关机设置

### 2. 门锁控制
- 通过舵机控制门锁的开关
- 开门后2秒自动关闭，确保安全

### 3. 网络功能
- 支持WiFi连接，自动保存配置
- 支持AP模式，提供网页配置界面
- 提供网页控制界面，可通过手机或电脑访问
- 支持GREE、KELVINATOR和TECO空调协议

## 硬件连接

| 功能 | 引脚 | ESP8266引脚标识 |
|------|------|----------------|
| 舵机 | SERVO_PIN | D6 (GPIO12) |
| IR发送 | IR_PIN | D5 (GPIO14) |
| IR接收 | RECV_PIN | D7 (GPIO13) |

## 代码结构

### 1. 主程序文件 (znjj.ino)
- 网络配置和管理
- 网页服务器实现
- 控制逻辑处理
- 红外信号接收和处理
- 舵机控制

### 2. 空调控制类 (YAP0F3AC.h / YAP0F3AC.cpp)
- 空调IR信号的发送和接收
- 空调状态的解析和更新
- 各种空调功能的控制接口

## 使用方法

### 1. 初始配置
1. 将ESP8266开发板连接到Arduino IDE
2. 安装所需库：ESP8266WiFi、ESP8266WebServer、DNSServer、EEPROM、Servo、IRremoteESP8266
3. 编译并上传代码到ESP8266
4. 首次启动时，ESP8266会进入AP模式，WiFi名称为"SmartHome_AP"，密码为"admin1234"
5. 连接到该WiFi网络，在浏览器中输入192.168.4.1，进入配置页面
6. 输入您的家庭WiFi信息，保存配置
7. 设备将重启并连接到您的家庭WiFi

### 2. 正常使用
1. 确保ESP8266已连接到家庭WiFi
2. 在浏览器中输入ESP8266的IP地址，进入控制界面
3. 选择"门锁"或"空调"选项卡进行相应控制

### 3. 空调控制说明
- 空调型号已固定为YAP0F3，无需额外配置
- 支持通过红外遥控器学习空调状态
- 支持通过网页界面远程控制所有空调功能

## 网页界面功能

### 1. 门锁控制页面
- 显示当前系统状态（AP模式或STA模式）
- 显示当前门锁状态
- 提供开门按钮，点击后门锁会打开2秒后自动关闭

### 2. 空调控制页面
- 显示当前系统状态
- 提供基础的开/关控制
- 温度调节（+/-按钮和滑块）
- 运行模式切换
- 风速控制
- 上下/左右扫风控制
- 灯光控制
- 睡眠模式切换
- 定时关机设置

### 3. 配置页面
- WiFi设置：输入SSID和密码
- 忘记网络：清除已保存的WiFi配置，恢复AP模式

## 技术细节

### 1. 红外信号处理
- 使用IRremoteESP8266库处理红外信号
- 支持GREE、KELVINATOR和TECO空调协议
- 实现了软件防抖，防止重复处理同一按键信号

### 2. 状态管理
- 使用EEPROM保存WiFi配置
- 实时解析和更新空调状态
- 支持通过红外遥控器和网页界面同步控制

### 3. 网络通信
- 使用ESP8266WebServer提供HTTP服务
- 支持AP模式和STA模式的自动切换
- 提供DNS服务器，支持在AP模式下通过任何域名访问

## 注意事项

1. 确保硬件连接正确，特别是IR发送和接收引脚
2. 首次使用时请确保ESP8266处于AP模式
3. 空调控制仅支持YAP0F3型号，其他型号可能不兼容
4. 门锁控制使用舵机，请注意电源供应
5. 定期检查设备状态，确保网络连接正常

## 扩展建议

1. 添加更多空调型号的支持
2. 实现MQTT协议，支持智能家居平台集成
3. 添加更多传感器（如温湿度传感器）
4. 实现语音控制功能
5. 添加手机APP支持

## 许可证

本项目采用MIT许可证，可自由使用和修改。

## 更新日志

- 初始版本：实现了基本的空调控制和门锁控制功能
- v1.1：添加了TECO协议支持和软件防抖逻辑
- v1.2：完善了网页界面，添加了更多控制选项

## 联系方式

如有问题或建议，欢迎提交Issue或Pull Request。
